<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Serhiy Naumenko">

<title>Foundations of Multidimensional data visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="multidimensional_visualization_files/libs/clipboard/clipboard.min.js"></script>
<script src="multidimensional_visualization_files/libs/quarto-html/quarto.js"></script>
<script src="multidimensional_visualization_files/libs/quarto-html/popper.min.js"></script>
<script src="multidimensional_visualization_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="multidimensional_visualization_files/libs/quarto-html/anchor.min.js"></script>
<link href="multidimensional_visualization_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="multidimensional_visualization_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="multidimensional_visualization_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="multidimensional_visualization_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="multidimensional_visualization_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="multidimensional_visualization_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="multidimensional_visualization_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="multidimensional_visualization_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="multidimensional_visualization_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="multidimensional_visualization_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="multidimensional_visualization_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="multidimensional_visualization_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="multidimensional_visualization_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="multidimensional_visualization_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#чи-всі-дані-в-біології-є-багатовимірними" id="toc-чи-всі-дані-в-біології-є-багатовимірними" class="nav-link active" data-scroll-target="#чи-всі-дані-в-біології-є-багатовимірними">1. Чи всі дані в біології є багатовимірними?</a></li>
  <li><a href="#найбільш-уживані-багатовимірні-дані" id="toc-найбільш-уживані-багатовимірні-дані" class="nav-link" data-scroll-target="#найбільш-уживані-багатовимірні-дані">2. Найбільш уживані багатовимірні дані</a></li>
  <li><a href="#обмеження-на-сприйняття-даних-високої-розмірності" id="toc-обмеження-на-сприйняття-даних-високої-розмірності" class="nav-link" data-scroll-target="#обмеження-на-сприйняття-даних-високої-розмірності">3. Обмеження на сприйняття даних високої розмірності</a></li>
  <li><a href="#проєкцій-мапи-земної-кулі" id="toc-проєкцій-мапи-земної-кулі" class="nav-link" data-scroll-target="#проєкцій-мапи-земної-кулі">4. Проєкцій мапи земної кулі</a></li>
  <li><a href="#корисні-проєкції-багатовимірних-даних-на-двомірну-площину-можливі" id="toc-корисні-проєкції-багатовимірних-даних-на-двомірну-площину-можливі" class="nav-link" data-scroll-target="#корисні-проєкції-багатовимірних-даних-на-двомірну-площину-можливі">5. Корисні проєкції багатовимірних даних на двомірну площину можливі</a></li>
  <li><a href="#метод-головних-компонент-pca" id="toc-метод-головних-компонент-pca" class="nav-link" data-scroll-target="#метод-головних-компонент-pca">6. Метод головних компонент (PCA)</a></li>
  <li><a href="#t-sne" id="toc-t-sne" class="nav-link" data-scroll-target="#t-sne">7. t-SNE</a></li>
  <li><a href="#umap" id="toc-umap" class="nav-link" data-scroll-target="#umap">8. UMAP</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a>
  <ul class="collapse">
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca">PCA</a></li>
  <li><a href="#tsne" id="toc-tsne" class="nav-link" data-scroll-target="#tsne">tSNE</a></li>
  <li><a href="#umap-1" id="toc-umap-1" class="nav-link" data-scroll-target="#umap-1">UMAP</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Foundations of Multidimensional data visualization</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Serhiy Naumenko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyverse and ggplot</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyverse")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># interactive plots</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("plotly")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># to plot pca objects</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggfortify")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("Rtsne")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("umap")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="чи-всі-дані-в-біології-є-багатовимірними" class="level1">
<h1>1. Чи всі дані в біології є багатовимірними?</h1>
<p>Перед тим, як перейти до багатовимірних даних, зазначимо, що далеко не всі дані в біології є багатовимірними, наприклад, значна кількість експериментів продукує часові ряди (time series), які є виміром величини у часі. (Див. графік Human hight - зріст у вікіпедії).</p>
<p>Однак дійсно, навіть найпростіші фенотипічні виміри рослин вже мають декілька покажчиків: експерименти Менделя мали 7 ознак посівного гороху, датасет iris (півники, ірис) в R має 4 виміри для кожної рослини: ширину і довжину пелюстки і чашолистка.</p>
</section>
<section id="найбільш-уживані-багатовимірні-дані" class="level1">
<h1>2. Найбільш уживані багатовимірні дані</h1>
<p>Окрім опису фенотипів, які потребують багато вимірів, типовими даними в сучасній біології є дані генетичної мінливості і дані експресії РНК.</p>
<p>У випадку генетичної мінливості дані генотипування, панельного, екзонного або геномного секвенування запроваджують молекулярні генотипи для мільйонів сайтів ДНК, тобто розмірність датасету популяційного генотипування біобанків може сягти 10^6 генотипів Х 10^6 зразків.</p>
<p>Дані популяційного генотипування можуть бути приведені до вигляду матриці генотипів (див. рис).</p>
<p>Дані експериментів вимірювання експресії генів мають вигляд матриці експресії Гени х Зразки, де кількість генів залежить від типу експеримента і може сягати від 20 до 50 тисяч, а кількість зразків від 6 (3 для експерименту і 3 для контролю) до десятків (складні експерименти з багатьма факторами, часові ряди тощо). Зазначимо, що в конкретному випадку матриця експресії має багато нулів, тому що не всі гени експресуються в даній тканині, типовий зразок тканини має менше 10 тисяч активних (білок-кодуючих) генів.</p>
<p>В експериментах з секвенування поодиноких клітин матриця експресії продукується для кожної клітини (великі експерименти мають до 100 тис клітин і більше). З причини особливості експриментів секвенування поодиноких клітин, в них вимірються експресія ще меншої кількості генів (3-5 тис максимум), однак наявність матриці експресії в кожній клітині збільшує складність датасета до 5,000 генів Х 50,000 клітин (клітини також можуть класифікуватись за експериментальними умовами і факторами, що додає додаткові виміри).</p>
<p>Мультимодальні експерименти дозволяють вимірювати не тільки еспресію генів, а, наприклад, стан хроматину чи експресію білків в кожній клітини, і аналізувати ці виміри разом. Мультимодальність додає додаткові виміри і ускладнює структуру датасета.</p>
</section>
<section id="обмеження-на-сприйняття-даних-високої-розмірності" class="level1">
<h1>3. Обмеження на сприйняття даних високої розмірності</h1>
<p>Людина може ефективно оперувати тільки 5-7 змінними водночас і ефективно сприймає майже виключно двомірні графіки (див. цитату із книги Клауса Вілке).</p>
<p>За століття розвитку науки напрацьовані математичні понятті і методи, які дозволяють описувати багатовимірну реальність: вектори, матриці, функції, метричні простори, векторні поля, статистичні методи, теорія динамічних систем, диференційні рівняння, чисельні методи та багато інших.</p>
</section>
<section id="проєкцій-мапи-земної-кулі" class="level1">
<h1>4. Проєкцій мапи земної кулі</h1>
<p>Найчастіше ми зустрічаємся із багатовимірним простором земної кулі, на якій ми мешкаємо. Це 3 фізичні координати, а також додаткові виміри - наявність водних перешкод, доріг, будинків, залізниці.</p>
<p>Навіть якщо сфокусуватись тільки на двомірній топографії, проєкція земної кулі на двомірний простір не є простим завданніям. Найуживаніша проєкція Меркатора зберігає локальну структуру меридіан x паралель як перендикулярних прямих, але значно деформує площини найближчі до полюсів, що призвело навіть до хибного сприйняття розміру окремих країн у масовій свідомості, наприклад, реальний відносний розмір Африки до Гренланції ~ 30 : 2.1.</p>
<p>Розроблені багато інших проєкцій, які зберігають площі та відстані між точками (див проєкцію AuthaGraph).</p>
</section>
<section id="корисні-проєкції-багатовимірних-даних-на-двомірну-площину-можливі" class="level1">
<h1>5. Корисні проєкції багатовимірних даних на двомірну площину можливі</h1>
<p>Як і випадку проєкцій земної кулі, проєкції біологічних та інших багатовимірних даних на двомірну площину, які дозволяють робити корисні аналізи і знаходити закономірності і патерни в даних, існують і постійно застосовуються в дослідженнях.</p>
<p>Деякі з поширених методів: PCA, tSNE, UMAP.</p>
<p>DataMap Plot - це готове рішення для великих датасетів на основі UMAP, яке дозволяє робити статичні і динамічні мапи для візуалізації великих датасетів (наприклад, всіх текстів Вікіпедії чи всіх статей в Архіві препринтів).</p>
</section>
<section id="метод-головних-компонент-pca" class="level1">
<h1>6. Метод головних компонент (PCA)</h1>
<p>Метод головних компонент (PCA) дозволяє обрати нову систему координат таким чином, що нові осі будуть впорядковані за рівнем варіації даних (перша вісь буде відповідати найбільшій варіації).</p>
<p>Найпростійший вступ до PCA можна знайти у короткому відео професора університету Північної Кароліни Джоша Стармера: <a href="https://www.youtube.com/watch?v=FgakZw6K1QQ">PCA step-by-step</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 5
$ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.…
$ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.…
$ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.…
$ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.…
$ Species      &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, s…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># чашолисток і пелюстка</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prcomp is from stats</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>pca_res <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(df, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># autoplot is from ggplot</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># usually loadings are not plotted</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(pca_res, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> iris, <span class="at">colour =</span> <span class="st">"Species"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">loadings =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">loadings.color =</span> <span class="st">"blue"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># interactive</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-00270b902aea86da96ac" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-00270b902aea86da96ac">{"x":{"data":[{"x":[-0.10787812947591469,-0.099125675878112357,-0.11261901870496881,-0.10953016321448951,-0.11383908813198693,-0.098871773947901434,-0.1164202464420892,-0.10636069950014732,-0.11120957980709059,-0.10404951888476797,-0.10319123578580514,-0.1108042281804522,-0.10567493993842451,-0.12542660197010241,-0.10473604861559879,-0.10775960147761923,-0.10515747600674921,-0.10433634251311094,-0.090437648059616085,-0.11162536167409048,-0.091187940080689756,-0.10513009315272294,-0.13215469858086837,-0.086631528926240001,-0.10608995163631636,-0.092975347751180062,-0.097705700059827913,-0.1032992268636943,-0.10191717081984242,-0.10790474216083294,-0.10194378350476073,-0.08724721718450619,-0.12456190317788098,-0.11652259199582779,-0.10050773192196423,-0.1051680129271555,-0.097419646600592963,-0.12038835219229906,-0.11573448688036636,-0.10335322240263892,-0.10891524512533129,-0.088510851910107463,-0.12164144999749403,-0.093575607692784266,-0.10179787265243898,-0.098591366012817053,-0.11359572312218226,-0.11405507028776528,-0.10619871288331358,-0.10497864345629543],"y":[-0.040858915836010472,0.057380916914182123,0.02910253571949694,0.050849040629995984,-0.055057350282864841,-0.12675584963675565,-0.0040553800042491843,-0.01899392322648796,0.094934488946111589,0.039921508037626563,-0.088836887082971966,-0.011327365063819754,0.062023476045196153,0.081841553796495936,-0.15832438784238534,-0.22865122991974712,-0.12628189884066157,-0.041608952036178627,-0.11959242485142484,-0.096000311868302671,-0.034800990347918392,-0.0786593906907707,-0.039013307763387385,-0.0072825727781850808,-0.01168282816089029,0.053251418585289249,-0.02061248332584778,-0.04486992646587986,-0.026660481389156158,0.028747072622426404,0.042945507069280769,-0.036064087350207677,-0.15266563453191276,-0.18306570920329523,0.039171471837458408,0.017543454625982904,-0.056310519860370382,-0.050414791151850845,0.076962019267434886,-0.022886446157333793,-0.037597941406309281,0.19895616178032224,0.040780104512034489,-0.040203513103884286,-0.097224298864564865,0.060523403644859849,-0.095368763367158021,0.032876570951319302,-0.084944364152126098,-0.00078447814976424345],"text":["PC1: -0.1078781295<br />PC2: -0.0408589158<br />Species: setosa","PC1: -0.0991256759<br />PC2:  0.0573809169<br />Species: setosa","PC1: -0.1126190187<br />PC2:  0.0291025357<br />Species: setosa","PC1: -0.1095301632<br />PC2:  0.0508490406<br />Species: setosa","PC1: -0.1138390881<br />PC2: -0.0550573503<br />Species: setosa","PC1: -0.0988717739<br />PC2: -0.1267558496<br />Species: setosa","PC1: -0.1164202464<br />PC2: -0.0040553800<br />Species: setosa","PC1: -0.1063606995<br />PC2: -0.0189939232<br />Species: setosa","PC1: -0.1112095798<br />PC2:  0.0949344889<br />Species: setosa","PC1: -0.1040495189<br />PC2:  0.0399215080<br />Species: setosa","PC1: -0.1031912358<br />PC2: -0.0888368871<br />Species: setosa","PC1: -0.1108042282<br />PC2: -0.0113273651<br />Species: setosa","PC1: -0.1056749399<br />PC2:  0.0620234760<br />Species: setosa","PC1: -0.1254266020<br />PC2:  0.0818415538<br />Species: setosa","PC1: -0.1047360486<br />PC2: -0.1583243878<br />Species: setosa","PC1: -0.1077596015<br />PC2: -0.2286512299<br />Species: setosa","PC1: -0.1051574760<br />PC2: -0.1262818988<br />Species: setosa","PC1: -0.1043363425<br />PC2: -0.0416089520<br />Species: setosa","PC1: -0.0904376481<br />PC2: -0.1195924249<br />Species: setosa","PC1: -0.1116253617<br />PC2: -0.0960003119<br />Species: setosa","PC1: -0.0911879401<br />PC2: -0.0348009903<br />Species: setosa","PC1: -0.1051300932<br />PC2: -0.0786593907<br />Species: setosa","PC1: -0.1321546986<br />PC2: -0.0390133078<br />Species: setosa","PC1: -0.0866315289<br />PC2: -0.0072825728<br />Species: setosa","PC1: -0.1060899516<br />PC2: -0.0116828282<br />Species: setosa","PC1: -0.0929753478<br />PC2:  0.0532514186<br />Species: setosa","PC1: -0.0977057001<br />PC2: -0.0206124833<br />Species: setosa","PC1: -0.1032992269<br />PC2: -0.0448699265<br />Species: setosa","PC1: -0.1019171708<br />PC2: -0.0266604814<br />Species: setosa","PC1: -0.1079047422<br />PC2:  0.0287470726<br />Species: setosa","PC1: -0.1019437835<br />PC2:  0.0429455071<br />Species: setosa","PC1: -0.0872472172<br />PC2: -0.0360640874<br />Species: setosa","PC1: -0.1245619032<br />PC2: -0.1526656345<br />Species: setosa","PC1: -0.1165225920<br />PC2: -0.1830657092<br />Species: setosa","PC1: -0.1005077319<br />PC2:  0.0391714718<br />Species: setosa","PC1: -0.1051680129<br />PC2:  0.0175434546<br />Species: setosa","PC1: -0.0974196466<br />PC2: -0.0563105199<br />Species: setosa","PC1: -0.1203883522<br />PC2: -0.0504147912<br />Species: setosa","PC1: -0.1157344869<br />PC2:  0.0769620193<br />Species: setosa","PC1: -0.1033532224<br />PC2: -0.0228864462<br />Species: setosa","PC1: -0.1089152451<br />PC2: -0.0375979414<br />Species: setosa","PC1: -0.0885108519<br />PC2:  0.1989561618<br />Species: setosa","PC1: -0.1216414500<br />PC2:  0.0407801045<br />Species: setosa","PC1: -0.0935756077<br />PC2: -0.0402035131<br />Species: setosa","PC1: -0.1017978727<br />PC2: -0.0972242989<br />Species: setosa","PC1: -0.0985913660<br />PC2:  0.0605234036<br />Species: setosa","PC1: -0.1135957231<br />PC2: -0.0953687634<br />Species: setosa","PC1: -0.1140550703<br />PC2:  0.0328765710<br />Species: setosa","PC1: -0.1061987129<br />PC2: -0.0849443642<br />Species: setosa","PC1: -0.1049786435<br />PC2: -0.0007844781<br />Species: setosa"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"setosa","legendgroup":"setosa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.05248286559157557,0.034836938939904936,0.059113508044858612,0.019410277590236474,0.051229767786380595,0.018514951565993889,0.035560618276060316,-0.023213406044772632,0.044200189399717711,0.00054428151154770424,-0.0052491516835850328,0.020992240025354703,0.026775783747931166,0.034276016389691313,-0.0015888367224858536,0.04169963931347833,0.016684085276965261,0.0075648472748071323,0.058356800330526371,0.0078557921302978128,0.035139190884909889,0.022687732382467816,0.05878953481119107,0.030145924022647683,0.033470958660565077,0.041645643774533725,0.059853263145525991,0.064707034848725017,0.031667475225562756,-0.0019177013524090919,0.0062303710766412933,0.0011171585991256211,0.011505570170990716,0.050544778393765796,0.010669131081948453,0.020441854395547361,0.049955702820417891,0.049755796429151559,0.0033148092925100237,0.013503314473108817,0.013293748010589026,0.029751109316415534,0.016030477244266487,-0.017252447388700399,0.013746679482913452,0.0043519249419266704,0.010847193463294234,0.027456004465548241,-0.021324422989651745,0.012229249507146114],"y":[-0.073454507858774901,-0.050612431075820932,-0.052458039148444026,0.14933140259654734,0.01774038780511053,0.050499131351237153,-0.065797877120890358,0.15767510529759127,-0.0027430201030992003,0.088013593377139446,0.22590943647949921,0.0053875614308792662,0.15020985392052266,0.015851070651938384,0.03736708619559443,-0.04333051859146661,0.016709667126346313,0.067421625194689958,0.13808218856287263,0.11087552500966093,-0.033755388119166667,0.03552147812297133,0.079442842702832223,0.0354421004299749,0.0053974888556630072,-0.021347038282920533,0.0065758798146941175,-0.028200596008411939,0.019230532780663095,0.090116031697377044,0.13297749301723047,0.13384601691642214,0.066158528192400659,0.053951485141754199,0.02449471298803799,-0.071974290308005978,-0.044436017888705298,0.1177172683536865,0.018683690322776669,0.11314948784114695,0.095334615867520844,-0.0021213990267383003,0.084130997871077348,0.17187353974444564,0.07283807475685368,0.01542271589307544,0.032763637070607483,0.013182534717354717,0.1314045289551018,0.050973082147331199],"text":["PC1:  0.0524828656<br />PC2: -0.0734545079<br />Species: versicolor","PC1:  0.0348369389<br />PC2: -0.0506124311<br />Species: versicolor","PC1:  0.0591135080<br />PC2: -0.0524580391<br />Species: versicolor","PC1:  0.0194102776<br />PC2:  0.1493314026<br />Species: versicolor","PC1:  0.0512297678<br />PC2:  0.0177403878<br />Species: versicolor","PC1:  0.0185149516<br />PC2:  0.0504991314<br />Species: versicolor","PC1:  0.0355606183<br />PC2: -0.0657978771<br />Species: versicolor","PC1: -0.0232134060<br />PC2:  0.1576751053<br />Species: versicolor","PC1:  0.0442001894<br />PC2: -0.0027430201<br />Species: versicolor","PC1:  0.0005442815<br />PC2:  0.0880135934<br />Species: versicolor","PC1: -0.0052491517<br />PC2:  0.2259094365<br />Species: versicolor","PC1:  0.0209922400<br />PC2:  0.0053875614<br />Species: versicolor","PC1:  0.0267757837<br />PC2:  0.1502098539<br />Species: versicolor","PC1:  0.0342760164<br />PC2:  0.0158510707<br />Species: versicolor","PC1: -0.0015888367<br />PC2:  0.0373670862<br />Species: versicolor","PC1:  0.0416996393<br />PC2: -0.0433305186<br />Species: versicolor","PC1:  0.0166840853<br />PC2:  0.0167096671<br />Species: versicolor","PC1:  0.0075648473<br />PC2:  0.0674216252<br />Species: versicolor","PC1:  0.0583568003<br />PC2:  0.1380821886<br />Species: versicolor","PC1:  0.0078557921<br />PC2:  0.1108755250<br />Species: versicolor","PC1:  0.0351391909<br />PC2: -0.0337553881<br />Species: versicolor","PC1:  0.0226877324<br />PC2:  0.0355214781<br />Species: versicolor","PC1:  0.0587895348<br />PC2:  0.0794428427<br />Species: versicolor","PC1:  0.0301459240<br />PC2:  0.0354421004<br />Species: versicolor","PC1:  0.0334709587<br />PC2:  0.0053974889<br />Species: versicolor","PC1:  0.0416456438<br />PC2: -0.0213470383<br />Species: versicolor","PC1:  0.0598532631<br />PC2:  0.0065758798<br />Species: versicolor","PC1:  0.0647070348<br />PC2: -0.0282005960<br />Species: versicolor","PC1:  0.0316674752<br />PC2:  0.0192305328<br />Species: versicolor","PC1: -0.0019177014<br />PC2:  0.0901160317<br />Species: versicolor","PC1:  0.0062303711<br />PC2:  0.1329774930<br />Species: versicolor","PC1:  0.0011171586<br />PC2:  0.1338460169<br />Species: versicolor","PC1:  0.0115055702<br />PC2:  0.0661585282<br />Species: versicolor","PC1:  0.0505447784<br />PC2:  0.0539514851<br />Species: versicolor","PC1:  0.0106691311<br />PC2:  0.0244947130<br />Species: versicolor","PC1:  0.0204418544<br />PC2: -0.0719742903<br />Species: versicolor","PC1:  0.0499557028<br />PC2: -0.0444360179<br />Species: versicolor","PC1:  0.0497557964<br />PC2:  0.1177172684<br />Species: versicolor","PC1:  0.0033148093<br />PC2:  0.0186836903<br />Species: versicolor","PC1:  0.0135033145<br />PC2:  0.1131494878<br />Species: versicolor","PC1:  0.0132937480<br />PC2:  0.0953346159<br />Species: versicolor","PC1:  0.0297511093<br />PC2: -0.0021213990<br />Species: versicolor","PC1:  0.0160304772<br />PC2:  0.0841309979<br />Species: versicolor","PC1: -0.0172524474<br />PC2:  0.1718735397<br />Species: versicolor","PC1:  0.0137466795<br />PC2:  0.0728380748<br />Species: versicolor","PC1:  0.0043519249<br />PC2:  0.0154227159<br />Species: versicolor","PC1:  0.0108471935<br />PC2:  0.0327636371<br />Species: versicolor","PC1:  0.0274560045<br />PC2:  0.0131825347<br />Species: versicolor","PC1: -0.0213244230<br />PC2:  0.1314045290<br />Species: versicolor","PC1:  0.0122292495<br />PC2:  0.0509730821<br />Species: versicolor"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"versicolor","legendgroup":"versicolor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.087865232632549153,0.05515518508716015,0.10504692072238106,0.068600948068330572,0.088972419585422388,0.13108428481290674,0.017482727312832975,0.10967569764639831,0.095587633722043416,0.10764350734914535,0.064981903939703656,0.076342898701634535,0.089738787371008072,0.06002503255487121,0.069910638342614989,0.075742638760030331,0.070090995190071628,0.11557712191942025,0.15770353861441377,0.060198973709069258,0.097065726306420172,0.046585685266959359,0.13802836357945103,0.063507932582474613,0.081013716627232071,0.093093499329062579,0.055975548411690453,0.048632533711766311,0.085187267612814019,0.088774037491158891,0.1160355922358504,0.10979422564469379,0.088729054575617763,0.053071941164923482,0.057279290697790274,0.13331820826246291,0.075084262052333803,0.064130036533999388,0.044053631099545951,0.088221357395240729,0.095974615118058965,0.090590654776712354,0.05515518508716015,0.097201100238335628,0.095180864478447008,0.089100607654971298,0.074528108177117941,0.072460292571543267,0.065392146962597805,0.045760430546173375],"y":[-0.074088543009709407,0.059486422402941434,-0.04783722182367954,0.00399949069836245,-0.025113632739749103,-0.068129250371073397,0.13291204213043184,-0.035755152503260647,0.060556253087732742,-0.16351260921944619,-0.058966061201648608,0.03589430941981929,-0.035685702235047953,0.098929311588043023,0.037645284024400545,-0.05756062226935426,-0.021758024842005945,-0.21761795622271238,-0.0015134792885253849,0.14527479592944678,-0.077497187719677563,0.048667450084811888,-0.035208310045374218,0.041010819346927359,-0.086303026835349669,-0.085780038608444867,0.02693087259909659,-0.0054770069244814571,0.015947816544712314,-0.047861076054661132,-0.022069778858527445,-0.2235474665869972,0.015197780344544162,0.02493299517168468,0.069057553493827292,-0.072929407207138003,-0.090955513391147422,-0.035956459288860314,-0.0014659962946121073,-0.057550694844570517,-0.052252732981430294,-0.058695304147836282,0.059486422402941434,-0.073841640186878721,-0.089303171636022305,-0.032937788607467891,0.076324210203136095,-0.02290263414527172,-0.086075978862086386,0.0020710635391631956],"text":["PC1:  0.0878652326<br />PC2: -0.0740885430<br />Species: virginica","PC1:  0.0551551851<br />PC2:  0.0594864224<br />Species: virginica","PC1:  0.1050469207<br />PC2: -0.0478372218<br />Species: virginica","PC1:  0.0686009481<br />PC2:  0.0039994907<br />Species: virginica","PC1:  0.0889724196<br />PC2: -0.0251136327<br />Species: virginica","PC1:  0.1310842848<br />PC2: -0.0681292504<br />Species: virginica","PC1:  0.0174827273<br />PC2:  0.1329120421<br />Species: virginica","PC1:  0.1096756976<br />PC2: -0.0357551525<br />Species: virginica","PC1:  0.0955876337<br />PC2:  0.0605562531<br />Species: virginica","PC1:  0.1076435073<br />PC2: -0.1635126092<br />Species: virginica","PC1:  0.0649819039<br />PC2: -0.0589660612<br />Species: virginica","PC1:  0.0763428987<br />PC2:  0.0358943094<br />Species: virginica","PC1:  0.0897387874<br />PC2: -0.0356857022<br />Species: virginica","PC1:  0.0600250326<br />PC2:  0.0989293116<br />Species: virginica","PC1:  0.0699106383<br />PC2:  0.0376452840<br />Species: virginica","PC1:  0.0757426388<br />PC2: -0.0575606223<br />Species: virginica","PC1:  0.0700909952<br />PC2: -0.0217580248<br />Species: virginica","PC1:  0.1155771219<br />PC2: -0.2176179562<br />Species: virginica","PC1:  0.1577035386<br />PC2: -0.0015134793<br />Species: virginica","PC1:  0.0601989737<br />PC2:  0.1452747959<br />Species: virginica","PC1:  0.0970657263<br />PC2: -0.0774971877<br />Species: virginica","PC1:  0.0465856853<br />PC2:  0.0486674501<br />Species: virginica","PC1:  0.1380283636<br />PC2: -0.0352083100<br />Species: virginica","PC1:  0.0635079326<br />PC2:  0.0410108193<br />Species: virginica","PC1:  0.0810137166<br />PC2: -0.0863030268<br />Species: virginica","PC1:  0.0930934993<br />PC2: -0.0857800386<br />Species: virginica","PC1:  0.0559755484<br />PC2:  0.0269308726<br />Species: virginica","PC1:  0.0486325337<br />PC2: -0.0054770069<br />Species: virginica","PC1:  0.0851872676<br />PC2:  0.0159478165<br />Species: virginica","PC1:  0.0887740375<br />PC2: -0.0478610761<br />Species: virginica","PC1:  0.1160355922<br />PC2: -0.0220697789<br />Species: virginica","PC1:  0.1097942256<br />PC2: -0.2235474666<br />Species: virginica","PC1:  0.0887290546<br />PC2:  0.0151977803<br />Species: virginica","PC1:  0.0530719412<br />PC2:  0.0249329952<br />Species: virginica","PC1:  0.0572792907<br />PC2:  0.0690575535<br />Species: virginica","PC1:  0.1333182083<br />PC2: -0.0729294072<br />Species: virginica","PC1:  0.0750842621<br />PC2: -0.0909555134<br />Species: virginica","PC1:  0.0641300365<br />PC2: -0.0359564593<br />Species: virginica","PC1:  0.0440536311<br />PC2: -0.0014659963<br />Species: virginica","PC1:  0.0882213574<br />PC2: -0.0575506948<br />Species: virginica","PC1:  0.0959746151<br />PC2: -0.0522527330<br />Species: virginica","PC1:  0.0905906548<br />PC2: -0.0586953041<br />Species: virginica","PC1:  0.0551551851<br />PC2:  0.0594864224<br />Species: virginica","PC1:  0.0972011002<br />PC2: -0.0738416402<br />Species: virginica","PC1:  0.0951808645<br />PC2: -0.0893031716<br />Species: virginica","PC1:  0.0891006077<br />PC2: -0.0329377886<br />Species: virginica","PC1:  0.0745281082<br />PC2:  0.0763242102<br />Species: virginica","PC1:  0.0724602926<br />PC2: -0.0229026341<br />Species: virginica","PC1:  0.0653921470<br />PC2: -0.0860759789<br />Species: virginica","PC1:  0.0457604305<br />PC2:  0.0020710635<br />Species: virginica"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"virginica","legendgroup":"virginica","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.10323225157830562,null,0,-0.053362429135956659,null,0,0.11498996391371941,null,0,0.11190793787411986],"y":[0,-0.074773016509267889,null,0,-0.1829209839357977,null,0,-0.0048522151986882568,null,0,-0.013262375920737916],"text":["x: 0<br />y: 0<br />PC1:  0.10323225<br />PC2: -0.074773017","x: 0<br />y: 0<br />PC1:  0.10323225<br />PC2: -0.074773017",null,"x: 0<br />y: 0<br />PC1: -0.05336243<br />PC2: -0.182920984","x: 0<br />y: 0<br />PC1: -0.05336243<br />PC2: -0.182920984",null,"x: 0<br />y: 0<br />PC1:  0.11498996<br />PC2: -0.004852215","x: 0<br />y: 0<br />PC1:  0.11498996<br />PC2: -0.004852215",null,"x: 0<br />y: 0<br />PC1:  0.11190794<br />PC2: -0.013262376","x: 0<br />y: 0<br />PC1:  0.11190794<br />PC2: -0.013262376"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.10323225157830562,-0.053362429135956659,0.11498996391371941,0.11190793787411986],"y":[-0.074773016509267889,-0.1829209839357977,-0.0048522151986882568,-0.013262375920737916],"text":["Sepal.Length","Sepal.Width","Petal.Length","Petal.Width"],"hovertext":["PC1:  0.10323225<br />PC2: -0.074773017<br />rownames: Sepal.Length","PC1: -0.05336243<br />PC2: -0.182920984<br />rownames: Sepal.Width","PC1:  0.11498996<br />PC2: -0.004852215<br />rownames: Petal.Length","PC1:  0.11190794<br />PC2: -0.013262376<br />rownames: Petal.Width"],"textfont":{"size":14.66456692913386,"color":"rgba(255,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.305936073059364,"r":7.3059360730593621,"b":37.260273972602747,"l":48.949771689497737},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.14664761044063249,0.17219645047417789],"tickmode":"array","ticktext":["-0.1","0.0","0.1"],"tickvals":[-0.10000000000000001,0,0.10000000000000003],"categoryorder":"array","categoryarray":["-0.1","0.0","0.1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"PC1 (72.96%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.25137926323970944,0.24863746979946152],"tickmode":"array","ticktext":["-0.2","-0.1","0.0","0.1","0.2"],"tickvals":[-0.20000000000000001,-0.10000000000000001,0,0.10000000000000003,0.20000000000000001],"categoryorder":"array","categoryarray":["-0.2","-0.1","0.0","0.1","0.2"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"PC2 (22.85%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716894984},"title":{"text":"Species","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"647342362fb0e":{"x":{},"y":{},"colour":{},"type":"scatter"},"647342cec6979":{"x":{},"y":{},"xend":{},"yend":{}},"6473463ecf7be":{"x":{},"y":{},"label":{}}},"cur_data":"647342362fb0e","visdat":{"647342362fb0e":["function (y) ","x"],"647342cec6979":["function (y) ","x"],"6473463ecf7be":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca_res, <span class="at">data =</span> iris, <span class="at">colour =</span> <span class="st">'Species'</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3</span>,  <span class="co"># PC2 vs PC3</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,  </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">"blue"</span>,  <span class="co"># Customize loading color</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="dv">0</span>,  <span class="co"># Adjusts the scaling of the loadings vectors (0 is often best)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"PCA Plot (PC2 vs PC3)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multidimensional_visualization_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of variance explained by each PC</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> pca_res<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>  <span class="co"># Eigenvalues</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>variance_explained <span class="ot">&lt;-</span> (eigenvalues <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3     PC4
Standard deviation     1.7084 0.9560 0.38309 0.14393
Proportion of Variance 0.7296 0.2285 0.03669 0.00518
Cumulative Proportion  0.7296 0.9581 0.99482 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for plotting</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>scree_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">PC =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(eigenvalues),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variance =</span> variance_explained</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the scree plot using ggplot2</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scree_data, <span class="fu">aes</span>(<span class="at">x =</span> PC, <span class="at">y =</span> Variance)) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Variance, <span class="dv">1</span>), <span class="st">"%"</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># Add percentage labels</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scree Plot"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Principal Component"</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variance (%)"</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="co"># Optional: Use a black and white theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multidimensional_visualization_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="t-sne" class="level1">
<h1>7. t-SNE</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rtsne)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>remove_iris_dup <span class="ot">&lt;-</span> <span class="fu">unique</span>(iris)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>iris_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(remove_iris_dup[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>tsne_out <span class="ot">&lt;-</span> <span class="fu">Rtsne</span>(iris_matrix)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>tsne_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> tsne_out<span class="sc">$</span>Y[,<span class="dv">1</span>], </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> tsne_out<span class="sc">$</span>Y[,<span class="dv">2</span>],</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">species =</span> remove_iris_dup<span class="sc">$</span>Species)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> tsne_plot <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y, <span class="at">colour =</span> species)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-cf2c55e1def6b0635a1d" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-cf2c55e1def6b0635a1d">{"x":{"data":[{"x":[-6.368466320198829,-5.4340963885745159,-6.5206217619139819,-6.149460896263073,-6.7279919622697877,-6.4999751791753688,-6.9142766157577844,-6.0557913133392089,-6.2492117409716093,-5.5815326929353208,-5.9888286836418114,-5.864871956242343,-5.6462868811002922,-6.771811285941765,-5.847210638666783,-6.2675552652425193,-6.190149933729554,-6.2580872055735846,-5.737181196123573,-6.7430446456003486,-5.3580248519067331,-6.6098396978530101,-7.6568362879507124,-5.0056032133993362,-4.9076887581346966,-5.0660875666927172,-5.4685543032189656,-6.0322971605734654,-5.9788577851797262,-5.9861112593706114,-5.527472902751164,-5.4108963180351664,-6.8362130691551322,-6.3583363109888831,-5.622173329804772,-6.5242025047897485,-5.4558839694011647,-6.951913329879015,-6.4972286348857153,-5.9859647768022173,-6.645640958407995,-5.8178705761501188,-6.8292990405944431,-5.120138798916793,-7.2274522994272807,-5.640584524820536,-6.8031934181211113,-6.4935100654199251,-6.2340136376244306,-6.1589090111952665],"y":[16.190729408202579,13.807486709101939,13.924695419353226,13.528579767180245,16.19470616464428,18.031718361292775,14.129104906825257,15.590841373785729,12.874993553211288,14.263881956247973,17.565738973373733,14.963640930579572,13.536742440515351,12.778375744792521,18.76068033833025,18.958071160818101,18.121898732531672,16.2463453162603,18.28494544539905,17.208744150183858,17.044337993057372,16.940782175222989,14.378416331455947,15.910039695477193,15.038838196387355,14.200379969498012,15.748424654087719,16.60314517720542,16.295341610220969,14.134492681645964,14.115966180328646,16.997881551036279,18.222320600815848,18.682879270483159,14.325193950958981,14.800729739095727,17.477707826580623,15.784723035464014,12.982213372865163,15.903094580222861,15.803538104178497,12.369972379294996,13.288445556451634,16.143427146831485,17.560669911664196,13.555163858891268,17.281344657313941,13.712468503644372,17.354628331374506,15.228475924537019],"text":["x: -6.368466<br />y:  16.1907294<br />species: setosa","x: -5.434096<br />y:  13.8074867<br />species: setosa","x: -6.520622<br />y:  13.9246954<br />species: setosa","x: -6.149461<br />y:  13.5285798<br />species: setosa","x: -6.727992<br />y:  16.1947062<br />species: setosa","x: -6.499975<br />y:  18.0317184<br />species: setosa","x: -6.914277<br />y:  14.1291049<br />species: setosa","x: -6.055791<br />y:  15.5908414<br />species: setosa","x: -6.249212<br />y:  12.8749936<br />species: setosa","x: -5.581533<br />y:  14.2638820<br />species: setosa","x: -5.988829<br />y:  17.5657390<br />species: setosa","x: -5.864872<br />y:  14.9636409<br />species: setosa","x: -5.646287<br />y:  13.5367424<br />species: setosa","x: -6.771811<br />y:  12.7783757<br />species: setosa","x: -5.847211<br />y:  18.7606803<br />species: setosa","x: -6.267555<br />y:  18.9580712<br />species: setosa","x: -6.190150<br />y:  18.1218987<br />species: setosa","x: -6.258087<br />y:  16.2463453<br />species: setosa","x: -5.737181<br />y:  18.2849454<br />species: setosa","x: -6.743045<br />y:  17.2087442<br />species: setosa","x: -5.358025<br />y:  17.0443380<br />species: setosa","x: -6.609840<br />y:  16.9407822<br />species: setosa","x: -7.656836<br />y:  14.3784163<br />species: setosa","x: -5.005603<br />y:  15.9100397<br />species: setosa","x: -4.907689<br />y:  15.0388382<br />species: setosa","x: -5.066088<br />y:  14.2003800<br />species: setosa","x: -5.468554<br />y:  15.7484247<br />species: setosa","x: -6.032297<br />y:  16.6031452<br />species: setosa","x: -5.978858<br />y:  16.2953416<br />species: setosa","x: -5.986111<br />y:  14.1344927<br />species: setosa","x: -5.527473<br />y:  14.1159662<br />species: setosa","x: -5.410896<br />y:  16.9978816<br />species: setosa","x: -6.836213<br />y:  18.2223206<br />species: setosa","x: -6.358336<br />y:  18.6828793<br />species: setosa","x: -5.622173<br />y:  14.3251940<br />species: setosa","x: -6.524203<br />y:  14.8007297<br />species: setosa","x: -5.455884<br />y:  17.4777078<br />species: setosa","x: -6.951913<br />y:  15.7847230<br />species: setosa","x: -6.497229<br />y:  12.9822134<br />species: setosa","x: -5.985965<br />y:  15.9030946<br />species: setosa","x: -6.645641<br />y:  15.8035381<br />species: setosa","x: -5.817871<br />y:  12.3699724<br />species: setosa","x: -6.829299<br />y:  13.2884456<br />species: setosa","x: -5.120139<br />y:  16.1434271<br />species: setosa","x: -7.227452<br />y:  17.5606699<br />species: setosa","x: -5.640585<br />y:  13.5551639<br />species: setosa","x: -6.803193<br />y:  17.2813447<br />species: setosa","x: -6.493510<br />y:  13.7124685<br />species: setosa","x: -6.234014<br />y:  17.3546283<br />species: setosa","x: -6.158909<br />y:  15.2284759<br />species: setosa"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"setosa","legendgroup":"setosa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.2160307308286296,3.9968346359830975,5.0022122884889466,2.6543882723523087,4.2635786643547195,2.4697759082391109,3.361387392536169,2.7949722465955364,4.6431585048015549,2.2128053421585498,2.703492987401459,3.0136519343539785,4.1886545130837236,3.1397853275475338,3.4894146360888572,4.875819485331939,2.1565698190754969,3.4478859145159935,4.8920663244902807,3.145013114462293,2.1969556285605831,3.7321938345974544,3.3712485363518532,3.32025031504108,4.268219471328524,4.6473808373252945,4.8469216311117771,4.4200293584813135,2.9370643656069575,3.5253304865093034,2.9893761504729448,3.0895335985398704,3.4063993916122026,2.4809523511725762,1.8605082097651797,2.4099937177134998,4.742496161533456,4.8245390188378119,2.6904843187394398,2.6841342380383102,2.1824425319688405,3.1769836712122301,3.3777179923969851,2.8139964943162856,2.6063278888364776,2.8514717019222409,2.8025084325180409,3.733705773613011,2.9051604058611913,2.9557992932103079],"y":[-7.6308654571303487,-6.5270940091268272,-7.9286048585426805,-2.201010951892119,-6.9086392897845972,-4.2286316665196573,-6.8400887825037655,-0.86188398232406693,-6.8469697696396778,-2.2099229683035611,-0.98154311940538497,-4.4118979851557629,-2.6304213596352035,-6.1475942680334681,-2.0951272441807287,-6.7712247669309349,-4.4545018097489351,-3.0510349702545465,-4.9234392713451989,-2.3314482850913225,-7.0861159280288595,-3.84868879675681,-8.0054643802466856,-5.7848632688631518,-5.811635307882919,-6.5536689092651583,-7.6228681281229296,-8.6788692940480825,-5.4779684514826705,-1.710368744100411,-1.9420126363621455,-1.7100456958801424,-2.8400704199125171,-8.3676052527460154,-4.1000395493684758,-6.0613726371747125,-7.4326149909849795,-4.8638623032201096,-3.4815215626907769,-2.4544016471483658,-3.2039559878781194,-5.9196509110551236,-2.880852840005526,-0.91601976385893513,-3.1716239165689357,-3.734900320510798,-3.6915431916411978,-5.2030625140238289,-0.7578757570693534,-3.2971465848809434],"text":["x:  5.216031<br />y:  -7.6308655<br />species: versicolor","x:  3.996835<br />y:  -6.5270940<br />species: versicolor","x:  5.002212<br />y:  -7.9286049<br />species: versicolor","x:  2.654388<br />y:  -2.2010110<br />species: versicolor","x:  4.263579<br />y:  -6.9086393<br />species: versicolor","x:  2.469776<br />y:  -4.2286317<br />species: versicolor","x:  3.361387<br />y:  -6.8400888<br />species: versicolor","x:  2.794972<br />y:  -0.8618840<br />species: versicolor","x:  4.643159<br />y:  -6.8469698<br />species: versicolor","x:  2.212805<br />y:  -2.2099230<br />species: versicolor","x:  2.703493<br />y:  -0.9815431<br />species: versicolor","x:  3.013652<br />y:  -4.4118980<br />species: versicolor","x:  4.188655<br />y:  -2.6304214<br />species: versicolor","x:  3.139785<br />y:  -6.1475943<br />species: versicolor","x:  3.489415<br />y:  -2.0951272<br />species: versicolor","x:  4.875819<br />y:  -6.7712248<br />species: versicolor","x:  2.156570<br />y:  -4.4545018<br />species: versicolor","x:  3.447886<br />y:  -3.0510350<br />species: versicolor","x:  4.892066<br />y:  -4.9234393<br />species: versicolor","x:  3.145013<br />y:  -2.3314483<br />species: versicolor","x:  2.196956<br />y:  -7.0861159<br />species: versicolor","x:  3.732194<br />y:  -3.8486888<br />species: versicolor","x:  3.371249<br />y:  -8.0054644<br />species: versicolor","x:  3.320250<br />y:  -5.7848633<br />species: versicolor","x:  4.268219<br />y:  -5.8116353<br />species: versicolor","x:  4.647381<br />y:  -6.5536689<br />species: versicolor","x:  4.846922<br />y:  -7.6228681<br />species: versicolor","x:  4.420029<br />y:  -8.6788693<br />species: versicolor","x:  2.937064<br />y:  -5.4779685<br />species: versicolor","x:  3.525330<br />y:  -1.7103687<br />species: versicolor","x:  2.989376<br />y:  -1.9420126<br />species: versicolor","x:  3.089534<br />y:  -1.7100457<br />species: versicolor","x:  3.406399<br />y:  -2.8400704<br />species: versicolor","x:  2.480952<br />y:  -8.3676053<br />species: versicolor","x:  1.860508<br />y:  -4.1000395<br />species: versicolor","x:  2.409994<br />y:  -6.0613726<br />species: versicolor","x:  4.742496<br />y:  -7.4326150<br />species: versicolor","x:  4.824539<br />y:  -4.8638623<br />species: versicolor","x:  2.690484<br />y:  -3.4815216<br />species: versicolor","x:  2.684134<br />y:  -2.4544016<br />species: versicolor","x:  2.182443<br />y:  -3.2039560<br />species: versicolor","x:  3.176984<br />y:  -5.9196509<br />species: versicolor","x:  3.377718<br />y:  -2.8808528<br />species: versicolor","x:  2.813996<br />y:  -0.9160198<br />species: versicolor","x:  2.606328<br />y:  -3.1716239<br />species: versicolor","x:  2.851472<br />y:  -3.7349003<br />species: versicolor","x:  2.802508<br />y:  -3.6915432<br />species: versicolor","x:  3.733706<br />y:  -5.2030625<br />species: versicolor","x:  2.905160<br />y:  -0.7578758<br />species: versicolor","x:  2.955799<br />y:  -3.2971466<br />species: versicolor"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"versicolor","legendgroup":"versicolor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.7741600226926051,1.6745977229206164,3.4604282448021433,3.5202755826743322,3.1067012265559244,3.6510726239589357,1.1413878714007073,3.9376650465462673,4.1668360899090473,2.6655302158085163,2.3932416220330635,3.1022133712821933,3.0417739474416319,1.324221433075595,1.2040896694204011,2.0727980078567247,3.4015043187497978,2.9917980820184087,3.9018656594392116,1.5256764931799955,2.8090134855365125,1.3048235083417861,3.826918974799761,2.9715921878424232,2.8153024494116972,3.734907208020219,2.8079515405049422,2.4642003240118755,3.3811269262053356,4.0911678337939152,3.9390026986152722,2.9983206853295084,3.2661918858472343,3.3099506971685133,3.53431651240839,3.4920656758659288,1.7352678456035127,3.2931815429584486,2.3622929429682884,2.881460179101873,2.5064044598522592,2.3135811020281101,2.7939393988286114,2.2752989177429255,2.4208670744426311,2.7685634956802012,2.6952916612310642,1.6230261157999579,2.0357624931202625],"y":[-12.822842430815287,-8.39476175249637,-13.462209200250564,-10.90599898591368,-12.268857179354988,-14.794323256658865,-3.1358728528145794,-14.222319282323824,-12.085118389284814,-14.11240009346028,-10.765125867955915,-10.228945357886204,-12.193914532136532,-8.3170055201502535,-8.9189915209431962,-11.571581790274092,-11.097267162445492,-14.985931198061168,-15.024643023848194,-7.4402598889280567,-12.979517795103343,-8.1397378001671505,-14.876282671223432,-8.4088589941750822,-12.671917387813185,-13.774388219710497,-7.9092788207566214,-7.7645480843400838,-11.497075548120115,-13.536676601549596,-14.132174414512681,-14.975836219859673,-11.6292269610578,-8.517474812045899,-9.7245145841793494,-14.523086480630106,-12.283623711056839,-11.010640855336478,-7.4296114917597516,-12.235092431778625,-12.498596764443716,-11.694495656846204,-13.147506581604448,-12.888180471481688,-11.595221561940935,-8.8852784181195492,-10.771171798271034,-11.830531039959618,-8.1754138477485885],"text":["x:  1.774160<br />y: -12.8228424<br />species: virginica","x:  1.674598<br />y:  -8.3947618<br />species: virginica","x:  3.460428<br />y: -13.4622092<br />species: virginica","x:  3.520276<br />y: -10.9059990<br />species: virginica","x:  3.106701<br />y: -12.2688572<br />species: virginica","x:  3.651073<br />y: -14.7943233<br />species: virginica","x:  1.141388<br />y:  -3.1358729<br />species: virginica","x:  3.937665<br />y: -14.2223193<br />species: virginica","x:  4.166836<br />y: -12.0851184<br />species: virginica","x:  2.665530<br />y: -14.1124001<br />species: virginica","x:  2.393242<br />y: -10.7651259<br />species: virginica","x:  3.102213<br />y: -10.2289454<br />species: virginica","x:  3.041774<br />y: -12.1939145<br />species: virginica","x:  1.324221<br />y:  -8.3170055<br />species: virginica","x:  1.204090<br />y:  -8.9189915<br />species: virginica","x:  2.072798<br />y: -11.5715818<br />species: virginica","x:  3.401504<br />y: -11.0972672<br />species: virginica","x:  2.991798<br />y: -14.9859312<br />species: virginica","x:  3.901866<br />y: -15.0246430<br />species: virginica","x:  1.525676<br />y:  -7.4402599<br />species: virginica","x:  2.809013<br />y: -12.9795178<br />species: virginica","x:  1.304824<br />y:  -8.1397378<br />species: virginica","x:  3.826919<br />y: -14.8762827<br />species: virginica","x:  2.971592<br />y:  -8.4088590<br />species: virginica","x:  2.815302<br />y: -12.6719174<br />species: virginica","x:  3.734907<br />y: -13.7743882<br />species: virginica","x:  2.807952<br />y:  -7.9092788<br />species: virginica","x:  2.464200<br />y:  -7.7645481<br />species: virginica","x:  3.381127<br />y: -11.4970755<br />species: virginica","x:  4.091168<br />y: -13.5366766<br />species: virginica","x:  3.939003<br />y: -14.1321744<br />species: virginica","x:  2.998321<br />y: -14.9758362<br />species: virginica","x:  3.266192<br />y: -11.6292270<br />species: virginica","x:  3.309951<br />y:  -8.5174748<br />species: virginica","x:  3.534317<br />y:  -9.7245146<br />species: virginica","x:  3.492066<br />y: -14.5230865<br />species: virginica","x:  1.735268<br />y: -12.2836237<br />species: virginica","x:  3.293182<br />y: -11.0106409<br />species: virginica","x:  2.362293<br />y:  -7.4296115<br />species: virginica","x:  2.881460<br />y: -12.2350924<br />species: virginica","x:  2.506404<br />y: -12.4985968<br />species: virginica","x:  2.313581<br />y: -11.6944957<br />species: virginica","x:  2.793939<br />y: -13.1475066<br />species: virginica","x:  2.275299<br />y: -12.8881805<br />species: virginica","x:  2.420867<br />y: -11.5952216<br />species: virginica","x:  2.768563<br />y:  -8.8852784<br />species: virginica","x:  2.695292<br />y: -10.7711718<br />species: virginica","x:  1.623026<br />y: -11.8305310<br />species: virginica","x:  2.035762<br />y:  -8.1754138<br />species: virginica"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"virginica","legendgroup":"virginica","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.305936073059364,"r":7.3059360730593621,"b":37.260273972602747,"l":43.105022831050242},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-8.30047963888968,5.8596740817675972],"tickmode":"array","ticktext":["-5","0","5"],"tickvals":[-5,0,5],"categoryorder":"array","categoryarray":["-5","0","5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"x","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-16.72377873308151,20.657206870051414],"tickmode":"array","ticktext":["-10","0","10","20"],"tickvals":[-10,0,10,20],"categoryorder":"array","categoryarray":["-10","0","10","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"y","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716894984},"title":{"text":"species","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"647341bd401ed":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"647341bd401ed","visdat":{"647341bd401ed":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="umap" class="level1">
<h1>8. UMAP</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(umap)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform UMAP transformation on the Iris dataset (excluding the 'Species' column)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># usually method="umap-learn" is used, you'd need a python package for that</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>iris_umap <span class="ot">&lt;-</span> <span class="fu">umap</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">n_neighbors =</span> <span class="dv">15</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">min_dist =</span> <span class="fl">0.1</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random_state =</span> <span class="dv">15</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>iris_umap_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> iris_umap<span class="sc">$</span>layout[, <span class="dv">1</span>],</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> iris_umap<span class="sc">$</span>layout[, <span class="dv">2</span>],</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">species =</span> iris<span class="sc">$</span>Species</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the UMAP plot</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris_umap_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7f523cc293e50453f234" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7f523cc293e50453f234">{"x":{"data":[{"x":[10.573182981448081,12.359408371936265,12.267499939373618,12.55826059462369,10.683550846883918,9.5667943846047798,12.215091020724287,11.024496659295068,12.816685919965,12.392983657078883,9.6517240889639915,11.510162549950326,12.484093010730785,12.955746942310249,9.1979178130761632,9.1236759862058889,9.348815642911795,10.454044953772655,9.3149935623912157,9.8098527872936572,10.005318056784315,10.218554897384163,12.018898082387327,10.873051532636364,11.615647607164547,12.233616053357022,10.95750241599255,10.235764002658147,10.499362492153221,12.225120333850782,12.264737893536445,10.093796003000982,9.4617859472660264,9.1707257163704128,12.125157452215884,11.478744424188239,9.7211386887247251,10.578546946270659,12.908533152360004,10.831216512121046,10.7438517172485,12.957212942285377,12.59812043917659,10.77603466608306,9.8590084493449304,12.597578515892142,9.7478083786337457,12.594178262324515,9.795946466233989,11.110853637813587],"y":[-1.3526464325552991,-2.0238703545056858,-1.3845588939092606,-1.3433085913277014,-1.4910669247440502,-0.71247829343754843,-1.0888979906693228,-1.3900244673402469,-1.4116810411522085,-1.8277692293034624,-0.87170876393389163,-1.2896459996068157,-1.8450537602902104,-1.2445162627533559,-0.90962948524263432,-1.0522848068133914,-0.80255331393404505,-1.3804251653807347,-0.93431466023457554,-0.68356509638204122,-1.1416811608587665,-0.5896773265554196,-1.1622093865330099,-1.0824359516043973,-1.3257876280280283,-2.0794404983243941,-0.98339161755204074,-1.1105234050277124,-1.2821419233078881,-1.4577002811307533,-1.701377081381227,-1.2300697094145767,-0.79213750948961836,-0.93878400548551033,-1.9583197875500158,-1.828335743383656,-1.1872215655725884,-1.5847091867324652,-1.2506332918859591,-1.2196768251304442,-1.5080890213271578,-1.469052210020676,-1.2153552216959409,-0.77812843967246748,-0.38000904475538277,-1.7476991285965395,-0.63854883456394074,-1.113282582599612,-0.82122912539327997,-1.560943920137138],"text":["x: 10.573183<br />y: -1.3526464<br />species: setosa","x: 12.359408<br />y: -2.0238704<br />species: setosa","x: 12.267500<br />y: -1.3845589<br />species: setosa","x: 12.558261<br />y: -1.3433086<br />species: setosa","x: 10.683551<br />y: -1.4910669<br />species: setosa","x:  9.566794<br />y: -0.7124783<br />species: setosa","x: 12.215091<br />y: -1.0888980<br />species: setosa","x: 11.024497<br />y: -1.3900245<br />species: setosa","x: 12.816686<br />y: -1.4116810<br />species: setosa","x: 12.392984<br />y: -1.8277692<br />species: setosa","x:  9.651724<br />y: -0.8717088<br />species: setosa","x: 11.510163<br />y: -1.2896460<br />species: setosa","x: 12.484093<br />y: -1.8450538<br />species: setosa","x: 12.955747<br />y: -1.2445163<br />species: setosa","x:  9.197918<br />y: -0.9096295<br />species: setosa","x:  9.123676<br />y: -1.0522848<br />species: setosa","x:  9.348816<br />y: -0.8025533<br />species: setosa","x: 10.454045<br />y: -1.3804252<br />species: setosa","x:  9.314994<br />y: -0.9343147<br />species: setosa","x:  9.809853<br />y: -0.6835651<br />species: setosa","x: 10.005318<br />y: -1.1416812<br />species: setosa","x: 10.218555<br />y: -0.5896773<br />species: setosa","x: 12.018898<br />y: -1.1622094<br />species: setosa","x: 10.873052<br />y: -1.0824360<br />species: setosa","x: 11.615648<br />y: -1.3257876<br />species: setosa","x: 12.233616<br />y: -2.0794405<br />species: setosa","x: 10.957502<br />y: -0.9833916<br />species: setosa","x: 10.235764<br />y: -1.1105234<br />species: setosa","x: 10.499362<br />y: -1.2821419<br />species: setosa","x: 12.225120<br />y: -1.4577003<br />species: setosa","x: 12.264738<br />y: -1.7013771<br />species: setosa","x: 10.093796<br />y: -1.2300697<br />species: setosa","x:  9.461786<br />y: -0.7921375<br />species: setosa","x:  9.170726<br />y: -0.9387840<br />species: setosa","x: 12.125157<br />y: -1.9583198<br />species: setosa","x: 11.478744<br />y: -1.8283357<br />species: setosa","x:  9.721139<br />y: -1.1872216<br />species: setosa","x: 10.578547<br />y: -1.5847092<br />species: setosa","x: 12.908533<br />y: -1.2506333<br />species: setosa","x: 10.831217<br />y: -1.2196768<br />species: setosa","x: 10.743852<br />y: -1.5080890<br />species: setosa","x: 12.957213<br />y: -1.4690522<br />species: setosa","x: 12.598120<br />y: -1.2153552<br />species: setosa","x: 10.776035<br />y: -0.7781284<br />species: setosa","x:  9.859008<br />y: -0.3800090<br />species: setosa","x: 12.597579<br />y: -1.7476991<br />species: setosa","x:  9.747808<br />y: -0.6385488<br />species: setosa","x: 12.594178<br />y: -1.1132826<br />species: setosa","x:  9.795946<br />y: -0.8212291<br />species: setosa","x: 11.110854<br />y: -1.5609439<br />species: setosa"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"setosa","legendgroup":"setosa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4.5751383588771857,-5.3517947933747347,-4.4670306625235545,-6.4938150028512815,-5.1056127276225647,-6.8667863120646988,-5.7005081959037094,-7.1874317299624746,-4.9462885106394099,-6.8444063755860416,-7.2060356580219063,-6.4790297427057322,-6.3914584262909218,-6.0246384795328982,-6.7554341057160645,-4.7997763554759985,-6.8709569356963707,-6.2886900348716557,-5.5436688909636391,-6.5924684691191997,-6.1051522934692404,-6.2077241515465422,-5.167523976070016,-6.0080927524089134,-5.4745290036076319,-5.0504244778003384,-4.7107807898965035,-4.3650233470027509,-6.2118075749449524,-6.6966120683837786,-6.7424795764251595,-6.6434420670936483,-6.2933928074067076,-5.5652687683678383,-7.0737159184923453,-5.9512720294122978,-4.6407666175655429,-5.5412600706808881,-6.6471247977395862,-6.7559737976851597,-6.9241320989811044,-5.9004458772818555,-6.5354042859853996,-7.259248427843092,-6.8189847036439133,-6.672803207809638,-6.5411565237014546,-5.9865834236874669,-7.1201721079300722,-6.5391671294870974],"y":[-0.95277236952163458,-0.80505945222436903,-0.8072408751583291,-3.3493230932470555,-0.86075703927229874,-2.192673800290164,-0.43655892277695552,-3.8643060341773099,-0.89114737770873109,-3.3361329689389789,-3.8640175306757865,-2.079439255459004,-3.3174482657454316,-0.93723028699068811,-3.4776716665108962,-1.083786669830439,-2.1355997786476895,-3.0383421202429446,-0.20544970468166035,-3.5278328874255562,0.38562595467200955,-2.4645550537876435,0.59389063908583051,-1.0670285675253433,-1.2317947973709988,-0.952669327120097,-0.82449754235477046,-0.33706049314652864,-1.2318524277220377,-3.7932557546381513,-3.6322031169668678,-3.8344728416472735,-3.1382797305173487,0.99657045984912807,-2.3709512702002709,-0.47457272173371523,-0.86279161298238138,-1.0974580312117177,-2.6180538031631944,-3.3845666349695458,-2.6705426773508094,-0.92486694512953571,-3.0870966413020593,-3.9566843015315714,-2.8129349548650557,-2.5235138626072402,-2.4505303787833705,-1.3822309368515016,-3.951175547580287,-2.8165373580493336],"text":["x: -4.575138<br />y: -0.9527724<br />species: versicolor","x: -5.351795<br />y: -0.8050595<br />species: versicolor","x: -4.467031<br />y: -0.8072409<br />species: versicolor","x: -6.493815<br />y: -3.3493231<br />species: versicolor","x: -5.105613<br />y: -0.8607570<br />species: versicolor","x: -6.866786<br />y: -2.1926738<br />species: versicolor","x: -5.700508<br />y: -0.4365589<br />species: versicolor","x: -7.187432<br />y: -3.8643060<br />species: versicolor","x: -4.946289<br />y: -0.8911474<br />species: versicolor","x: -6.844406<br />y: -3.3361330<br />species: versicolor","x: -7.206036<br />y: -3.8640175<br />species: versicolor","x: -6.479030<br />y: -2.0794393<br />species: versicolor","x: -6.391458<br />y: -3.3174483<br />species: versicolor","x: -6.024638<br />y: -0.9372303<br />species: versicolor","x: -6.755434<br />y: -3.4776717<br />species: versicolor","x: -4.799776<br />y: -1.0837867<br />species: versicolor","x: -6.870957<br />y: -2.1355998<br />species: versicolor","x: -6.288690<br />y: -3.0383421<br />species: versicolor","x: -5.543669<br />y: -0.2054497<br />species: versicolor","x: -6.592468<br />y: -3.5278329<br />species: versicolor","x: -6.105152<br />y:  0.3856260<br />species: versicolor","x: -6.207724<br />y: -2.4645551<br />species: versicolor","x: -5.167524<br />y:  0.5938906<br />species: versicolor","x: -6.008093<br />y: -1.0670286<br />species: versicolor","x: -5.474529<br />y: -1.2317948<br />species: versicolor","x: -5.050424<br />y: -0.9526693<br />species: versicolor","x: -4.710781<br />y: -0.8244975<br />species: versicolor","x: -4.365023<br />y: -0.3370605<br />species: versicolor","x: -6.211808<br />y: -1.2318524<br />species: versicolor","x: -6.696612<br />y: -3.7932558<br />species: versicolor","x: -6.742480<br />y: -3.6322031<br />species: versicolor","x: -6.643442<br />y: -3.8344728<br />species: versicolor","x: -6.293393<br />y: -3.1382797<br />species: versicolor","x: -5.565269<br />y:  0.9965705<br />species: versicolor","x: -7.073716<br />y: -2.3709513<br />species: versicolor","x: -5.951272<br />y: -0.4745727<br />species: versicolor","x: -4.640767<br />y: -0.8627916<br />species: versicolor","x: -5.541260<br />y: -1.0974580<br />species: versicolor","x: -6.647125<br />y: -2.6180538<br />species: versicolor","x: -6.755974<br />y: -3.3845666<br />species: versicolor","x: -6.924132<br />y: -2.6705427<br />species: versicolor","x: -5.900446<br />y: -0.9248669<br />species: versicolor","x: -6.535404<br />y: -3.0870966<br />species: versicolor","x: -7.259248<br />y: -3.9566843<br />species: versicolor","x: -6.818985<br />y: -2.8129350<br />species: versicolor","x: -6.672803<br />y: -2.5235139<br />species: versicolor","x: -6.541157<br />y: -2.4505304<br />species: versicolor","x: -5.986583<br />y: -1.3822309<br />species: versicolor","x: -7.120172<br />y: -3.9511755<br />species: versicolor","x: -6.539167<br />y: -2.8165374<br />species: versicolor"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"versicolor","legendgroup":"versicolor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4.3769663187035057,-6.0979531854217974,-4.7898750444010361,-4.2197523237682555,-4.1493608697873663,-4.6430739220089041,-7.160174073737319,-4.6882728444871962,-4.1736305160048541,-5.0942641421280044,-4.581253611292718,-4.4380350570685296,-4.5415849588022468,-6.2671902166559708,-6.2642144002626416,-4.5220328593181049,-4.4331993283653448,-4.7219076629639591,-4.4456435971263693,-5.2522873254102294,-4.715114313728467,-6.3536566321350136,-4.9455236595791972,-5.3740815480427804,-4.6627107281014188,-4.8691112290780918,-5.6401913335979632,-5.9477821490835607,-4.0572587357656582,-4.7972117798948943,-4.7767146377433578,-4.554453009983952,-4.0211201385628241,-5.3320175005483197,-5.1648007338666488,-4.8401871963305254,-4.3383405941828137,-4.2598571110079373,-6.0011566446735323,-4.5358067799807307,-4.9875534350315212,-4.7005854323707439,-6.1414060870957954,-4.7913399727559058,-4.8336714911235177,-4.7144338493077491,-5.1746051126091581,-4.5133084137701545,-4.1019006476583133,-5.9587858035238277],"y":[4.3117779222062165,1.032355509414538,4.8921440121407276,3.151788251405748,4.0575429120801818,5.4584521000835391,-2.7291326664188027,5.4173175667207527,3.3373135444752093,5.0517271583525352,3.4131905064532368,2.9230984683891679,3.8819761441512028,1.0612304184703172,1.0836501565351129,3.7655688975419981,3.0468511321899978,5.5818523219462781,5.6797139466956228,0.7606712041391932,4.4619321249333863,1.0823589234198348,5.7171691744456874,0.62895750908867454,4.4925998466467991,5.1433007707359319,0.45427425173169,0.56211972425810508,3.3702844039544901,5.165397503788804,5.3470300710399972,5.4685649744675606,3.6098082605606767,0.9585207905768065,1.510128452279172,5.5345472354784935,4.2689751874167854,3.2216952833782155,0.45521816501209855,4.1274319698936175,4.1757480389029604,3.7657324187294847,1.0587663058910499,4.5837995150873523,4.4145375808068801,3.8725356985984631,0.65301310689227909,3.2647605888171332,3.9367067526983099,0.77246718775120993],"text":["x: -4.376966<br />y:  4.3117779<br />species: virginica","x: -6.097953<br />y:  1.0323555<br />species: virginica","x: -4.789875<br />y:  4.8921440<br />species: virginica","x: -4.219752<br />y:  3.1517883<br />species: virginica","x: -4.149361<br />y:  4.0575429<br />species: virginica","x: -4.643074<br />y:  5.4584521<br />species: virginica","x: -7.160174<br />y: -2.7291327<br />species: virginica","x: -4.688273<br />y:  5.4173176<br />species: virginica","x: -4.173631<br />y:  3.3373135<br />species: virginica","x: -5.094264<br />y:  5.0517272<br />species: virginica","x: -4.581254<br />y:  3.4131905<br />species: virginica","x: -4.438035<br />y:  2.9230985<br />species: virginica","x: -4.541585<br />y:  3.8819761<br />species: virginica","x: -6.267190<br />y:  1.0612304<br />species: virginica","x: -6.264214<br />y:  1.0836502<br />species: virginica","x: -4.522033<br />y:  3.7655689<br />species: virginica","x: -4.433199<br />y:  3.0468511<br />species: virginica","x: -4.721908<br />y:  5.5818523<br />species: virginica","x: -4.445644<br />y:  5.6797139<br />species: virginica","x: -5.252287<br />y:  0.7606712<br />species: virginica","x: -4.715114<br />y:  4.4619321<br />species: virginica","x: -6.353657<br />y:  1.0823589<br />species: virginica","x: -4.945524<br />y:  5.7171692<br />species: virginica","x: -5.374082<br />y:  0.6289575<br />species: virginica","x: -4.662711<br />y:  4.4925998<br />species: virginica","x: -4.869111<br />y:  5.1433008<br />species: virginica","x: -5.640191<br />y:  0.4542743<br />species: virginica","x: -5.947782<br />y:  0.5621197<br />species: virginica","x: -4.057259<br />y:  3.3702844<br />species: virginica","x: -4.797212<br />y:  5.1653975<br />species: virginica","x: -4.776715<br />y:  5.3470301<br />species: virginica","x: -4.554453<br />y:  5.4685650<br />species: virginica","x: -4.021120<br />y:  3.6098083<br />species: virginica","x: -5.332018<br />y:  0.9585208<br />species: virginica","x: -5.164801<br />y:  1.5101285<br />species: virginica","x: -4.840187<br />y:  5.5345472<br />species: virginica","x: -4.338341<br />y:  4.2689752<br />species: virginica","x: -4.259857<br />y:  3.2216953<br />species: virginica","x: -6.001157<br />y:  0.4552182<br />species: virginica","x: -4.535807<br />y:  4.1274320<br />species: virginica","x: -4.987553<br />y:  4.1757480<br />species: virginica","x: -4.700585<br />y:  3.7657324<br />species: virginica","x: -6.141406<br />y:  1.0587663<br />species: virginica","x: -4.791340<br />y:  4.5837995<br />species: virginica","x: -4.833671<br />y:  4.4145376<br />species: virginica","x: -4.714434<br />y:  3.8725357<br />species: virginica","x: -5.174605<br />y:  0.6530131<br />species: virginica","x: -4.513308<br />y:  3.2647606<br />species: virginica","x: -4.101901<br />y:  3.9367068<br />species: virginica","x: -5.958786<br />y:  0.7724672<br />species: virginica"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"virginica","legendgroup":"virginica","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-8.2700714963495159,13.968036010791801],"tickmode":"array","ticktext":["-5","0","5","10"],"tickvals":[-5,0,5,10],"categoryorder":"array","categoryarray":["-5","0","5","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"x","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.4403769753304339,6.2008618482445499],"tickmode":"array","ticktext":["-4","-2","0","2","4","6"],"tickvals":[-4,-2,0,2,4,6],"categoryorder":"array","categoryarray":["-4","-2","0","2","4","6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"y","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"species","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"647341a389873":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"647341a389873","visdat":{"647341a389873":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="references" class="level1">
<h1>References</h1>
<section id="pca" class="level2">
<h2 class="anchored" data-anchor-id="pca">PCA</h2>
<ul>
<li><a href="https://uk.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BD%D0%B8%D1%85_%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82">PCA - вікіпедія</a></li>
<li><a href="https://www.youtube.com/watch?v=FgakZw6K1QQ">PCA step-by-step by Josh Starmer</a></li>
<li><a href="https://www.huber.embl.de/msmb/07-chap.html">PCA із прикладами в R із книги “Modern Statistics for Modern biology” by Susan Holmes and Wolfgang Huber</a></li>
<li><a href="https://www.nature.com/articles/s41598-022-14395-4">PCA-based findings in population genetics studies are highly biased and must be reevaluated</a></li>
<li><a href="https://www.pnas.org/doi/epub/10.1073/pnas.2311420120">Phantom oscillations in PCA</a></li>
</ul>
</section>
<section id="tsne" class="level2">
<h2 class="anchored" data-anchor-id="tsne">tSNE</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=NEaUSP4YerM">StatQuest: t-SNE, Clearly Explained</a></li>
<li><a href="https://uk.wikipedia.org/wiki/T-%D1%80%D0%BE%D0%B7%D0%BF%D0%BE%D0%B4%D1%96%D0%BB%D0%B5%D0%BD%D0%B5_%D0%B2%D0%BA%D0%BB%D0%B0%D0%B4%D0%B5%D0%BD%D0%BD%D1%8F_%D1%81%D1%82%D0%BE%D1%85%D0%B0%D1%81%D1%82%D0%B8%D1%87%D0%BD%D0%BE%D1%97_%D0%B1%D0%BB%D0%B8%D0%B7%D1%8C%D0%BA%D0%BE%D1%81%D1%82%D1%96">tSNE in Ukrainian</a></li>
<li><a href="https://lvdmaaten.github.io/tsne/">tSNE from the author</a></li>
<li><a href="https://www.nature.com/articles/s41467-019-13056-x">The art of using t-SNE for single-cell transcriptomics</a></li>
<li><a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1011288">The specious art of single-cell genomics</a></li>
<li><a href="https://www.biorxiv.org/content/10.1101/2024.03.26.586728v2.full.pdf">The art of seeing elephant in the room</a></li>
<li><a href="https://www.r-bloggers.com/2019/05/quick-and-easy-t-sne-analysis-in-r/">Quick and easy t-SNE analysis in R</a></li>
<li><a href="https://www.youtube.com/watch?v=MnRskV3NY1k">Introduction to Machine Learning - 11 - Manifold learning and t-SNE</a></li>
</ul>
</section>
<section id="umap-1" class="level2">
<h2 class="anchored" data-anchor-id="umap-1">UMAP</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=7CGdTuaQqKw">t-SNE vs UMAP</a></li>
<li><a href="https://intobioinformatics.wordpress.com/2019/06/08/running-umap-for-data-visualisation-in-r/">Running UMAP for data visualization in R</a></li>
<li><a href="https://simplystatistics.org/posts/2024-12-23-biologists-stop-including-umap-plots-in-your-papers/">Biologists, stop putting UMAP plots in your papers</a></li>
<li><a href="https://galaxy.opensyllabus.org/">Open Syllabus Galaxy - UMAP</a></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>